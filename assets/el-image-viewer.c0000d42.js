import{m as ve,E as B,a as D}from"./typescript.7c7271d2.js";import{j as p,M as be,g as ee,as as de,r as I,at as Ie,s as _e,d as le,n as me,o as pe,l as _,A as oe,E as d,B as C,z as w,q as v,x as e,G as Le,p as L,m as O,F as re,C as Ee,Y as Ce,k as ze,v as xe,I as ie,y as J,T as Te,Q as Oe,u as Se,D as Ne,H as Ae,f as $e}from"./index.b2e5e9b8.js";import{T as Me,i as N,a6 as Re,d as ge,e as ue,c as ce,a7 as Be,a8 as De,u as we,E as T,o as Ve,a9 as Pe,a2 as Fe,aa as Ye,ab as Xe,ac as je,ad as He,_ as ye,ae as We,w as he,z as Ze,af as Ke}from"./base.ab928bac.js";import{d as Ue,u as ke,a as qe,I as Ge}from"./IconPark.vue_vue_type_script_setup_true_lang.ef3966b8.js";import{a as Qe}from"./scroll.fc7cd787.js";var Je="Expected a function";function se(n,i,s){var o=!0,m=!0;if(typeof n!="function")throw new TypeError(Je);return Me(s)&&(o="leading"in s?!!s.leading:o,m="trailing"in s?!!s.trailing:m),Ue(n,i,{leading:o,maxWait:i,trailing:m})}const et=(n,i)=>{if(!N||!n||!i)return!1;const s=n.getBoundingClientRect();let o;return i instanceof Element?o=i.getBoundingClientRect():o={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<o.bottom&&s.bottom>o.top&&s.right>o.left&&s.left<o.right},fe=n=>{let i=0,s=n;for(;s;)i+=s.offsetTop,s=s.offsetParent;return i},Lt=(n,i)=>Math.abs(fe(n)-fe(i)),tt=()=>N&&/firefox/i.test(window.navigator.userAgent),at=["class","style"],nt=/^on[A-Z]/,st=(n={})=>{const{excludeListeners:i=!1,excludeKeys:s}=n,o=p(()=>((s==null?void 0:s.value)||[]).concat(at)),m=be();return m?p(()=>{var g;return Re(Object.entries((g=m.proxy)==null?void 0:g.$attrs).filter(([A])=>!o.value.includes(A)&&!(i&&nt.test(A))))}):p(()=>({}))},lt=ge({urlList:{type:ue(Array),default:()=>ve([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ot={close:()=>!0,switch:n=>ce(n)},rt=["src"],it=ee({name:"ElImageViewer"}),ut=ee({...it,props:lt,emits:ot,setup(n,{expose:i,emit:s}){const o=n,m={CONTAIN:{name:"contain",icon:de(Be)},ORIGINAL:{name:"original",icon:de(De)}},g=tt()?"DOMMouseScroll":"mousewheel",{t:A}=ke(),u=we("image-viewer"),{nextZIndex:V}=qe(),y=I(),E=I([]),$=Ie(),h=I(!0),f=I(o.initialIndex),M=_e(m.CONTAIN),c=I({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),P=p(()=>{const{urlList:t}=o;return t.length<=1}),j=p(()=>f.value===0),H=p(()=>f.value===o.urlList.length-1),F=p(()=>o.urlList[f.value]),te=p(()=>{const{scale:t,deg:l,offsetX:r,offsetY:k,enableTransition:z}=c.value;let b=r/t,x=k/t;switch(l%360){case 90:case-270:[b,x]=[x,-b];break;case 180:case-180:[b,x]=[-b,-x];break;case 270:case-90:[b,x]=[-x,b];break}const R={transform:`scale(${t}) rotate(${l}deg) translate(${b}px, ${x}px)`,transition:z?"transform .3s":""};return M.value.name===m.CONTAIN.name&&(R.maxWidth=R.maxHeight="100%"),R}),W=p(()=>ce(o.zIndex)?o.zIndex:V());function S(){ne(),s("close")}function ae(){const t=se(r=>{switch(r.code){case B.esc:o.closeOnPressEscape&&S();break;case B.space:q();break;case B.left:G();break;case B.up:a("zoomIn");break;case B.right:Q();break;case B.down:a("zoomOut");break}}),l=se(r=>{(r.wheelDelta?r.wheelDelta:-r.detail)>0?a("zoomIn",{zoomRate:1.2,enableTransition:!1}):a("zoomOut",{zoomRate:1.2,enableTransition:!1})});$.run(()=>{D(document,"keydown",t),D(document,g,l)})}function ne(){$.stop()}function Z(){h.value=!1}function K(t){h.value=!1,t.target.alt=A("el.image.error")}function U(t){if(h.value||t.button!==0||!y.value)return;c.value.enableTransition=!1;const{offsetX:l,offsetY:r}=c.value,k=t.pageX,z=t.pageY,b=se(R=>{c.value={...c.value,offsetX:l+R.pageX-k,offsetY:r+R.pageY-z}}),x=D(document,"mousemove",b);D(document,"mouseup",()=>{x()}),t.preventDefault()}function Y(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function q(){if(h.value)return;const t=We(m),l=Object.values(m),r=M.value.name,z=(l.findIndex(b=>b.name===r)+1)%t.length;M.value=m[t[z]],Y()}function X(t){const l=o.urlList.length;f.value=(t+l)%l}function G(){j.value&&!o.infinite||X(f.value-1)}function Q(){H.value&&!o.infinite||X(f.value+1)}function a(t,l={}){if(h.value)return;const{zoomRate:r,rotateDeg:k,enableTransition:z}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...l};switch(t){case"zoomOut":c.value.scale>.2&&(c.value.scale=Number.parseFloat((c.value.scale/r).toFixed(3)));break;case"zoomIn":c.value.scale<7&&(c.value.scale=Number.parseFloat((c.value.scale*r).toFixed(3)));break;case"clockwise":c.value.deg+=k;break;case"anticlockwise":c.value.deg-=k;break}c.value.enableTransition=z}return le(F,()=>{me(()=>{const t=E.value[0];t!=null&&t.complete||(h.value=!0)})}),le(f,t=>{Y(),s("switch",t)}),pe(()=>{var t,l;ae(),(l=(t=y.value)==null?void 0:t.focus)==null||l.call(t)}),i({setActiveItem:X}),(t,l)=>(_(),oe(Oe,{to:"body",disabled:!t.teleported},[d(Te,{name:"viewer-fade",appear:""},{default:C(()=>[w("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:v(e(u).e("wrapper")),style:ie({zIndex:e(W)})},[w("div",{class:v(e(u).e("mask")),onClick:l[0]||(l[0]=Le(r=>t.hideOnClickModal&&S(),["self"]))},null,2),L(" CLOSE "),w("span",{class:v([e(u).e("btn"),e(u).e("close")]),onClick:S},[d(e(T),null,{default:C(()=>[d(e(Ve))]),_:1})],2),L(" ARROW "),e(P)?L("v-if",!0):(_(),O(re,{key:0},[w("span",{class:v([e(u).e("btn"),e(u).e("prev"),e(u).is("disabled",!t.infinite&&e(j))]),onClick:G},[d(e(T),null,{default:C(()=>[d(e(Pe))]),_:1})],2),w("span",{class:v([e(u).e("btn"),e(u).e("next"),e(u).is("disabled",!t.infinite&&e(H))]),onClick:Q},[d(e(T),null,{default:C(()=>[d(e(Fe))]),_:1})],2)],64)),L(" ACTIONS "),w("div",{class:v([e(u).e("btn"),e(u).e("actions")])},[w("div",{class:v(e(u).e("actions__inner"))},[d(e(T),{onClick:l[1]||(l[1]=r=>a("zoomOut"))},{default:C(()=>[d(e(Ye))]),_:1}),d(e(T),{onClick:l[2]||(l[2]=r=>a("zoomIn"))},{default:C(()=>[d(e(Xe))]),_:1}),w("i",{class:v(e(u).e("actions__divider"))},null,2),d(e(T),{onClick:q},{default:C(()=>[(_(),oe(Ee(e(M).icon)))]),_:1}),w("i",{class:v(e(u).e("actions__divider"))},null,2),d(e(T),{onClick:l[3]||(l[3]=r=>a("anticlockwise"))},{default:C(()=>[d(e(je))]),_:1}),d(e(T),{onClick:l[4]||(l[4]=r=>a("clockwise"))},{default:C(()=>[d(e(He))]),_:1})],2)],2),L(" CANVAS "),w("div",{class:v(e(u).e("canvas"))},[(_(!0),O(re,null,Ce(t.urlList,(r,k)=>ze((_(),O("img",{ref_for:!0,ref:z=>E.value[k]=z,key:r,src:r,style:ie(e(te)),class:v(e(u).e("img")),onLoad:Z,onError:K,onMousedown:U},null,46,rt)),[[xe,k===f.value]])),128))],2),J(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ct=ye(ut,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const dt=he(ct),ft=ge({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:ue([String,Object])},previewSrcList:{type:ue(Array),default:()=>ve([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),vt={load:n=>n instanceof Event,error:n=>n instanceof Event,switch:n=>ce(n),close:()=>!0,show:()=>!0},mt=["src","loading"],pt={key:0},gt=ee({name:"ElImage",inheritAttrs:!1}),wt=ee({...gt,props:ft,emits:vt,setup(n,{emit:i}){const s=n;let o="";const{t:m}=ke(),g=we("image"),A=Se(),u=st(),V=I(),y=I(!1),E=I(!0),$=I(!1),h=I(),f=I(),M=N&&"loading"in HTMLImageElement.prototype;let c,P;const j=p(()=>A.style),H=p(()=>{const{fit:a}=s;return N&&a?{objectFit:a}:{}}),F=p(()=>{const{previewSrcList:a}=s;return Array.isArray(a)&&a.length>0}),te=p(()=>{const{previewSrcList:a,initialIndex:t}=s;let l=t;return t>a.length-1&&(l=0),l}),W=p(()=>s.loading==="eager"?!1:!M&&s.loading==="lazy"||s.lazy),S=()=>{!N||(E.value=!0,y.value=!1,V.value=s.src)};function ae(a){E.value=!1,y.value=!1,i("load",a)}function ne(a){E.value=!1,y.value=!0,i("error",a)}function Z(){et(h.value,f.value)&&(S(),Y())}const K=Ke(Z,200);async function U(){var a;if(!N)return;await me();const{scrollContainer:t}=s;Ze(t)?f.value=t:$e(t)&&t!==""?f.value=(a=document.querySelector(t))!=null?a:void 0:h.value&&(f.value=Qe(h.value)),f.value&&(c=D(f,"scroll",K),setTimeout(()=>Z(),100))}function Y(){!N||!f.value||!K||(c==null||c(),f.value=void 0)}function q(a){if(!!a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function X(){!F.value||(P=D("wheel",q,{passive:!1}),o=document.body.style.overflow,document.body.style.overflow="hidden",$.value=!0,i("show"))}function G(){P==null||P(),document.body.style.overflow=o,$.value=!1,i("close")}function Q(a){i("switch",a)}return le(()=>s.src,()=>{W.value?(E.value=!0,y.value=!1,Y(),U()):S()}),pe(()=>{W.value?U():S()}),(a,t)=>(_(),O("div",{ref_key:"container",ref:h,class:v([e(g).b(),a.$attrs.class]),style:ie(e(j))},[V.value!==void 0&&!y.value?(_(),O("img",Ne({key:0},e(u),{src:V.value,loading:a.loading,style:e(H),class:[e(g).e("inner"),e(F)&&e(g).e("preview"),E.value&&e(g).is("loading")],onClick:X,onLoad:ae,onError:ne}),null,16,mt)):L("v-if",!0),E.value||y.value?(_(),O("div",{key:1,class:v(e(g).e("wrapper"))},[E.value?J(a.$slots,"placeholder",{key:0},()=>[w("div",{class:v(e(g).e("placeholder"))},null,2)]):y.value?J(a.$slots,"error",{key:1},()=>[w("div",{class:v(e(g).e("error"))},Ae(e(m)("el.image.error")),3)]):L("v-if",!0)],2)):L("v-if",!0),e(F)?(_(),O(re,{key:2},[$.value?(_(),oe(e(dt),{key:0,"z-index":a.zIndex,"initial-index":e(te),infinite:a.infinite,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:G,onSwitch:Q},{default:C(()=>[a.$slots.viewer?(_(),O("div",pt,[J(a.$slots,"viewer")])):L("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):L("v-if",!0)],64)):L("v-if",!0)],6))}});var yt=ye(wt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const Et=he(yt),Ct=Ge("play",!0,function(n){return d("svg",{width:n.size,height:n.size,viewBox:"0 0 48 48",fill:"none"},[d("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:n.colors[1],stroke:n.colors[0],"stroke-width":n.strokeWidth,"stroke-linejoin":n.strokeLinejoin},null),d("path",{d:"M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z",fill:n.colors[3],stroke:n.colors[2],"stroke-width":n.strokeWidth,"stroke-linejoin":n.strokeLinejoin},null)])});export{Et as E,Ct as P,Lt as g,se as t,st as u};
