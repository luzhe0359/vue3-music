import"./base.ab928bac.js";import{_ as U}from"./_plugin-vue_export-helper.cdc0426e.js";import{i as P,n as R,l as f,m as g,aN as Y,aO as z,z as h,g as K,X,r as k,S as q,j as J,o as Q,E as v,B as m,F as w,Y as T,x,k as V,v as W,A as B,a5 as $,H as I,a1 as Z,aP as ee}from"./index.b2e5e9b8.js";import{c as te}from"./el-popper.25be0f7c.js";import{E as oe}from"./el-popover.e573734c.js";import{E as ne}from"./el-button.291b702e.js";import{u as A}from"./video.7e682225.js";import{_ as se}from"./IconPark.vue_vue_type_script_setup_true_lang.ef3966b8.js";import{_ as ie}from"./CoverPlay.vue_vue_type_style_index_0_lang.06daec29.js";import{t as O,g as re}from"./el-image-viewer.c0000d42.js";import{t as le}from"./error.47aa3b19.js";import{a as ce}from"./scroll.fc7cd787.js";import{R as ae}from"./Right.3b88d182.js";import"./typescript.7c7271d2.js";import"./size.61511ff8.js";import"./index.57e87d43.js";import"./PlayOne.39c5e1c9.js";const d="ElInfiniteScroll",de=50,ue=200,_e=0,pe={delay:{type:Number,default:ue},distance:{type:Number,default:_e},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},N=(e,t)=>Object.entries(pe).reduce((o,[n,l])=>{var s,r;const{type:u,default:_}=l,c=e.getAttribute(`infinite-scroll-${n}`);let a=(r=(s=t[c])!=null?s:c)!=null?r:_;return a=a==="false"?!1:a,a=u(a),o[n]=Number.isNaN(a)?_:a,o},{}),F=e=>{const{observer:t}=e[d];t&&(t.disconnect(),delete e[d].observer)},fe=(e,t)=>{const{container:o,containerEl:n,instance:l,observer:s,lastScrollTop:r}=e[d],{disabled:u,distance:_}=N(e,l),{clientHeight:c,scrollHeight:a,scrollTop:b}=n,S=b-r;if(e[d].lastScrollTop=b,s||u||S<0)return;let p=!1;if(o===e)p=a-(c+b)<=_;else{const{clientTop:y,scrollHeight:E}=e,C=re(e,n);p=b+c>=C+y+E-_}p&&t.call(l)};function D(e,t){const{containerEl:o,instance:n}=e[d],{disabled:l}=N(e,n);l||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?t.call(n):F(e))}const ve={async mounted(e,t){const{instance:o,value:n}=t;P(n)||le(d,"'v-infinite-scroll' binding value must be a function"),await R();const{delay:l,immediate:s}=N(e,o),r=ce(e,!0),u=r===window?document.documentElement:r,_=O(fe.bind(null,e,n),l);if(!!r){if(e[d]={instance:o,container:r,containerEl:u,delay:l,cb:n,onScroll:_,lastScrollTop:u.scrollTop},s){const c=new MutationObserver(O(D.bind(null,e,n),de));e[d].observer=c,c.observe(e,{childList:!0,subtree:!0}),D(e,n)}r.addEventListener("scroll",_)}},unmounted(e){const{container:t,onScroll:o}=e[d];t==null||t.removeEventListener("scroll",o),F(e)},async updated(e){e[d]||await R();const{containerEl:t,cb:o,observer:n}=e[d];t.clientHeight&&n&&D(e,o)}},L=ve;L.install=e=>{e.directive("InfiniteScroll",L)};const me=L;const ge={},he=e=>(Y("data-v-6346748a"),e=e(),z(),e),be={class:"mt-8 flex justify-center items-center"},ye=he(()=>h("div",{class:"loader"},null,-1)),Ee=[ye];function Se(e,t){return f(),g("div",be,Ee)}const xe=U(ge,[["render",Se],["__scopeId","data-v-6346748a"]]),ke={class:"flex justify-between items-center"},we=h("span",null,"\u5168\u90E8\u89C6\u9891",-1),Ce=$(" \u5168\u90E8\u89C6\u9891 "),Te={class:"h-96 mt-4 p-5 border-t"},Ie={class:"text-xs gap-5 grid grid-flow-row grid-cols-5"},De={class:"flex gap-x-4"},$e=["infinite-scroll-disabled"],Le={class:"text-xs mt-3 truncate"},qe=K({__name:"Index",setup(e){const t=Z(),{videoGroup:o}=X(A()),{getVideoGroup:n}=A(),l=k([]),s=q({page:0,id:0}),r=k(!1),u=k(!1),_=J(()=>r.value||u.value),c=k(),a=async()=>{try{const{datas:p,hasmore:y}=await ee(s.id,s.page-1);l.value=[...l.value,...p],r.value=!1,u.value=!y}catch{r.value=!1,u.value=!0}},b=()=>{r.value=!0,s.page++,a()},S=p=>{c.value.hide(),s.page=0,l.value=[],s.id=p};return Q(()=>{n()}),(p,y)=>{const E=ne,C=te,j=oe,G=xe,M=me;return f(),g(w,null,[h("div",ke,[v(j,{ref_key:"popoverRef",ref:c,placement:"bottom-start",width:"50%",trigger:"hover"},{reference:m(()=>[v(E,{class:"m-2",round:""},{default:m(()=>[we,v(se,{icon:x(ae)},null,8,["icon"])]),_:1})]),default:m(()=>[v(C,null,{default:m(()=>[v(E,{type:s.id===0?"primary":"",text:s.id===0,round:"",onClick:y[0]||(y[0]=i=>S(0))},{default:m(()=>[Ce]),_:1},8,["type","text"]),h("div",Te,[h("div",Ie,[(f(!0),g(w,null,T(x(o),i=>(f(),B(E,{key:i.id,type:i.id===s.id?"primary":"",text:i.id!==s.id,round:"",onClick:H=>S(i.id)},{default:m(()=>[$(I(i.name),1)]),_:2},1032,["type","text","onClick"]))),128))])])]),_:1})]),_:1},512),h("div",De,[(f(!0),g(w,null,T(x(o).slice(0,8),i=>(f(),B(E,{key:i.id,type:i.id===s.id?"primary":"",link:"",round:"",onClick:H=>S(i.id)},{default:m(()=>[$(I(i.name),1)]),_:2},1032,["type","onClick"]))),128))])]),V((f(),g("div",{key:s.id,"infinite-scroll-disabled":x(_),class:"grid grid-flow-row grid-cols-2 lg:grid-cols-4 gap-5 mt-5"},[(f(!0),g(w,null,T(l.value,({data:i})=>(f(),g("div",{key:i.vid},[v(ie,{"pic-url":i.coverUrl||i.liveData.liveRoom.coverUrl,video:"",onClick:H=>x(t).push(`/videoDetail/${i.vid}`)},null,8,["pic-url","onClick"]),h("div",Le,I(i.title||i.liveData.liveRoom.title),1)]))),128))],8,$e)),[[M,b]]),V(v(G,null,null,512),[[W,r.value]])],64)}}});export{qe as default};
